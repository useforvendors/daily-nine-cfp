<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Daily Nine</title>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
        font-family: 'Palatino', serif;
        background: linear-gradient(to bottom, #d4d0c5 0%, #c5c0b5 100%);
        color: #3d3a32;
        padding: 40px 20px;
        min-height: 100vh;
        text-align: center;
        line-height: 1.6;
    }

    .header h1 {
        font-size: 2em;
        font-weight: 400;
        letter-spacing: 12px;
        margin-bottom: 10px;
        text-transform: lowercase;
    }

    .header p { 
        font-size: 0.95em; 
        letter-spacing: 3px; 
        margin-bottom: 40px;
        color: #4a4740;
    }

    .grid-container {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 16px;
        max-width: 1400px;
        margin: 0 auto;
    }

    .essay-box {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        aspect-ratio: 1;
        cursor: pointer;
        transition: transform 0.3s ease, opacity 0.3s ease, background 0.4s ease;
        opacity: 0.95;
        border-radius: 12px;
        background: rgba(255,255,255,0.04);
        box-shadow: 0 2px 6px rgba(90, 84, 71, 0.08);
        padding: 8%;
        text-decoration: none;
        color: inherit;
        position: relative;
    }

    .essay-box:hover {
        transform: scale(1.12);
        opacity: 1;
        background: rgba(255,255,255,0.25);
    }

    .enso-icon {
        width: 64%;
        height: 64%;
        display: block;
        transition: all 0.3s ease;
    }

    .essay-title {
        position: absolute;
        bottom: 15%;
        left: 50%;
        transform: translateX(-50%);
        width: 80%;
        font-size: 0.9em;
        line-height: 1.3;
        opacity: 0;
        transition: opacity 0.3s ease;
        text-align: center;
        pointer-events: none;
    }

    .essay-box:hover .essay-title {
        opacity: 1;
    }

    .essay-box:hover .enso-icon {
        transform: translateY(-15%);
    }

    /* Nine different colors for the enso circles */
    .essay-box:nth-child(1) { color: #a86b5a; }
    .essay-box:nth-child(2) { color: #b88a4d; }
    .essay-box:nth-child(3) { color: #9d9159; }
    .essay-box:nth-child(4) { color: #6b8a6b; }
    .essay-box:nth-child(5) { color: #5a7a8a; }
    .essay-box:nth-child(6) { color: #8a6b7a; }
    .essay-box:nth-child(7) { color: #9a6b76; }
    .essay-box:nth-child(8) { color: #5a6a8a; }
    .essay-box:nth-child(9) { color: #9a5a76; }

    @media (max-width: 1024px) {
        .grid-container { grid-template-columns: repeat(2, 1fr); }
    }

    @media (max-width: 640px) {
        .grid-container { grid-template-columns: 1fr; }
        .header h1 { font-size: 1.5em; letter-spacing: 8px; }
    }

    .loading {
        grid-column: 1/-1;
        padding: 60px 20px;
        color: #8a8373;
        font-size: 0.9em;
        letter-spacing: 2px;
    }
</style>
</head>
<body>
    <div class="header">
        <h1>daily nine</h1>
        <p>nine perspectives<br>refreshed daily</p>
    </div>

    <div class="grid-container" id="grid">
        <div class="loading">loading essays...</div>
    </div>

<script>
// Nine unique enso paths
const ENSO_PATHS = [
    "M18,52 C28,18 62,12 82,44 C76,66 58,82 36,78 C22,74 18,64 18,52 Z",
    "M22,48 C34,16 66,14 78,42 C72,64 56,80 36,74 C26,70 22,58 22,48 Z",
    "M28,46 C38,20 62,18 76,44 C68,66 52,78 36,72 C28,68 26,56 28,46 Z",
    "M20,50 C32,22 64,20 80,50 C72,72 54,86 34,78 C24,72 20,60 20,50 Z",
    "M50,14 A36,36 0 1 1 49.9 14",
    "M18,50 C30,28 60,18 78,46 C70,68 54,82 36,76 C26,70 18,60 18,50 Z",
    "M50,16 C68,22 80,38 74,58 C66,78 52,82 36,74 C22,66 18,48 34,36 C44,28 50,20 50,16 Z",
    "M50,12 C30,16 18,38 28,60 C42,80 64,88 80,68 C88,54 78,28 50,12 Z",
    "M26,20 C36,32 50,36 62,40 C74,44 78,58 66,72 C54,84 36,84 24,70 C18,60 18,38 26,20 Z"
];

function ensoSVG(index) {
    const id = 'enso-' + index;
    const path = ENSO_PATHS[index];
    const seed = (index * 13 + 7) % 100;
    const baseStroke = (index === 4 || index === 6) ? 7 : 9;

    return `
    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <defs>
        <filter id="${id}-grain">
          <feTurbulence baseFrequency="0.45" numOctaves="3" seed="${seed}" result="turb" />
          <feColorMatrix type="saturate" values="0" in="turb" result="mono" />
          <feComposite in="mono" in2="SourceGraphic" operator="in" result="grainMask" />
          <feBlend in="SourceGraphic" in2="grainMask" mode="multiply" />
        </filter>
        <filter id="${id}-ink">
          <feTurbulence baseFrequency="0.6" numOctaves="2" seed="${(seed+17)%100}" result="t" />
          <feDisplacementMap in="SourceGraphic" in2="t" scale="8" xChannelSelector="R" yChannelSelector="G" />
        </filter>
      </defs>

      <g fill="currentColor" opacity="0.98">
        <path d="${path}" stroke="none" transform="translate(0,0) scale(1)" stroke-linecap="round" />
      </g>

      <g filter="url(#${id}-ink)" fill="none" stroke="currentColor" stroke-width="${baseStroke}" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.98">
        <path d="${path}" />
      </g>

      <g opacity="0.22" transform="scale(1.02) translate(-1 -1)" fill="none" stroke="currentColor" stroke-width="${Math.max(3, Math.floor(baseStroke/2))}" stroke-linecap="round">
        <path d="${path}" />
      </g>

      <g filter="url(#${id}-grain)" opacity="0.06">
        <rect x="0" y="0" width="100" height="100" fill="currentColor" />
      </g>
    </svg>
    `;
}

// Load essays from API (Cloudflare Pages path)
async function loadEssays() {
    try {
        const response = await fetch('/api/daily-articles');
        const essays = await response.json();
        renderGrid(essays);
    } catch (error) {
        console.error('Error loading essays:', error);
        document.getElementById('grid').innerHTML = '<div class="loading" style="color: #a86b5a;">unable to load essays<br>please refresh</div>';
    }
}

function renderGrid(essays) {
   const grid = document.getElementById('grid');
   grid.innerHTML = '';


   essays.forEach((essay, index) => {
       const box = document.createElement('a');
       // Link to internal clean-reader page
box.href = `/read?url=${encodeURIComponent(essay.url)}`;
box.target = '_self';

       box.className = 'essay-box';
       box.innerHTML = `
           <div class="enso-icon">${ensoSVG(index)}</div>
           <div class="essay-title">${essay.title}</div>
       `;
       grid.appendChild(box);
   });
}


// Fetch real essays on page load
loadEssays();

</script>
</body>
</html>